# Enable Rewrite Engine
RewriteEngine On

# Allow CORS
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"

# API Routes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Auth routes
RewriteRule ^api/auth/login$ api/auth/login.php [L]
RewriteRule ^api/auth/register$ api/auth/register.php [L]
RewriteRule ^api/auth/me$ api/auth/me.php [L]
RewriteRule ^api/auth/logout$ api/auth/logout.php [L]

# Products routes (specific routes MUST come before general route)
RewriteRule ^api/products/admin/?$ api/products/admin.php [L,QSA]
RewriteRule ^api/products/approve/?$ api/products/approve.php [L,QSA]
RewriteRule ^api/products/reject/?$ api/products/reject.php [L,QSA]
RewriteRule ^api/products/create/?$ api/products/create.php [L,QSA]
RewriteRule ^api/products/([0-9]+)/?$ api/products/show.php [L,QSA]
RewriteRule ^api/products/?$ api/products/index.php [L,QSA]

# Categories routes
RewriteRule ^api/categories$ api/categories/index.php [L]

# Orders routes
RewriteRule ^api/orders$ api/orders/index.php [L]
RewriteRule ^api/orders/create$ api/orders/create.php [L]

# Sellers routes (Admin)
RewriteRule ^api/sellers/test/?$ api/sellers/test.php [L,QSA]
RewriteRule ^api/sellers/create/?$ api/sellers/create.php [L,QSA]
RewriteRule ^api/sellers/approve/?$ api/sellers/approve.php [L,QSA]
RewriteRule ^api/sellers/reject/?$ api/sellers/reject.php [L,QSA]
RewriteRule ^api/sellers/?$ api/sellers/index.php [L,QSA]

# Users routes (Admin)
RewriteRule ^api/users/approve/?$ api/users/approve.php [L,QSA]
RewriteRule ^api/users/reject/?$ api/users/reject.php [L,QSA]
RewriteRule ^api/users/?$ api/users/index.php [L,QSA]

# Seller routes
RewriteRule ^api/seller/test/?$ api/seller/test.php [L,QSA]
RewriteRule ^api/seller/products-test/?$ api/seller/products-test.php [L,QSA]
RewriteRule ^api/seller/me/?$ api/seller/me.php [L,QSA]
# Seller products routes (specific routes MUST come before general route)
RewriteCond %{REQUEST_METHOD} PUT
RewriteRule ^api/seller/products/([0-9]+)/?$ api/seller/products/update.php [L,QSA]
RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^api/seller/products/([0-9]+)/?$ api/seller/products/delete.php [L,QSA]
RewriteRule ^api/seller/products/?$ api/seller/products.php [L,QSA]

# Default to index.php
RewriteRule ^$ index.php [L]

